{% if award and award.image %}
    {% set image_url = award.image.url %}
{% elif badge.image %}
    {% set image_url = badge.image.url %}
{% else %}
    {# TODO: Put the URL for default badge image in settings #}
    {% set image_url = static("img/default-badge.png") %}
{% endif %}

<div class="panel">
    <div class="section group">
        <div class="col span_1_of_3">
            {% block badge_image %}
                <img src="{{ image_url }}" width="256" height="256" class="image">
            {% endblock %}
        </div>
        <div class="meta col span_2_of_3">
            {% if badge.description %}
                <blockquote class="description">
                    <p>{{ badge.description | bleach_markup }}</p>
                </blockquote>
            {% endif %}
            <div class="section group">
                <div class="col span_1_of_2">
                    <dl class="meta">
                        {% block badge_meta %}
                            {% if badge.creator %}
                                <dt class="creator">{{ _("Created by") }}</dt>
                                    <dd class="creator"><a href="{{ badge.creator.get_absolute_url() }}">{{ badge.creator }}</a></dd>
                            {% endif %}
                            <dt class="created">{{ _("Created on") }}</dt>
                                <dd class="created">{{ badge.created.date() }}</dd>
                            {# if badge.created != badge.modified %}
                                <dt class="modified">{{ _("Modified on") }}</dt>
                                    <dd class="modified">{{ badge.modified.date() }}</dd>
                            {% endif #}
                        {% endblock %}
                    </dl>
                </div>
                <div class="col span_1_of_2">
                    {% if badge.tags and badge.tags.count() %}
                        <ul class="tags small-tags">
                            {% for tag in badge.tags.all() %}
                                <li><a class="tag" href="{{ url('badger.badges_list', tag_name=tag.name) }}">{{ tag.name }}</a></li>
                            {% endfor %}
                        </ul>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
    {% if show_actions != false %}
        {% block actions %}
            {% set can_edit = badge.allows_edit_by(request.user) %}
            {% set can_delete = badge.allows_delete_by(request.user) %}
            {% if can_edit or can_delete %}
                <p class="actions">
                    {% if can_edit %}
                        <a class="button edit" href="{{ url('badger.views.edit', badge.slug) }}">{{ _('Edit badge') }}</a>
                    {% endif %}
                    {% if can_delete %}
                        <a class="button delete" href="{{ url('badger.views.delete', badge.slug) }}">{{ _('Delete badge') }}</a>
                    {% endif %}
                </p>
            {% endif %}
        {% endblock %}
    {% endif %}
</div>
